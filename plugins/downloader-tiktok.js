//import _0x56a6x1 from '\x61\x78\x69\x6F\x73';
//import _0x56a6x2 from '\x63\x68\x65\x65\x72\x69\x6F';
//let _0x56a6=["\x63\x68\x61\x74","\x2A\x5B\xE2\x9D\x97\xEF\xB8\x8F\x49\x4E\x46\x4F\xE2\x9D\x97\xEF\xB8\x8F\x5D\x20\xCA\x98\x4E\x4C\x41\x43\x45\x20\x44\x45\x20\x54\x49\x4B\x54\x4F\x4B\x20\x46\x41\x4C\x54\x41\x4E\x54\x45\x2C\x20\x50\x4F\x52\x20\x46\x41\x56\x4F\x52\x20\x49\x4E\x47\x52\x45\x53\x45\x20\x45\x4E\x20\x45\x4E\x4C\x41\x43\x45\x2F\x4C\x49\x4E\x4B\x20\x44\x45\x20\x41\x4C\x47\x55\x4E\x20\x56\x49\x44\x45\x4F\x20\x44\x45\x20\x54\x49\x4B\x54\x4F\x4B\x2A\x0A\x0A\x2A\x2D\xE2\x97\x8B\x20\x45\x4A\x45\x4D\x50\x4C\x4F\x3A\x2A\x0A\x2A","\x20\x68\x74\x74\x70\x73\x3A\x2F\x2F\x76\x6D\x2E\x74\x69\x6B\x74\x6F\x6B\x2E\x63\x6F\x6D\x2F\x5A\x4D\x46\x62\x34\x42\x58\x56\x64\x2F","\x72\x65\x70\x6C\x79","\x5B\xE2\x9D\x97\x5D\x20\xCA\x98\x47\x55\x41\x52\x44\x45\x20\x55\x4E\x20\x4D\x4F\x4D\x45\x4E\x54\x4F\x20\x45\x4E\x20\x4C\x4F\x20\x51\x55\x45\x20\x45\x4E\x56\x49\x4F\x20\x53\x55\x20\x56\x49\x44\x45\x4F\x20\x44\x45\x20\x54\x49\x4B\x54\x4F\x4B\x2A","\x76\x69\x64\x65\x6F","\x74\x79\x70\x65","\x6E\x69\x63\x6B\x6E\x61\x6D\x65","\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6F\x6E","\x74\x72\x69\x6D","\x5C\x60\x2A\x54\x49\x54\x55\x4C\x4F\x2A\x3A\x60\x20","\x5C\x60\x2A\x44\x45\x53\x43\x52\x49\x50\x43\x49\x4F\x4E\x2A\x3A\x60\x20","\x2D","\x5C\x6E\x60\x2A\x54\x69\x70\x6F\x2A\x3A\x60\x20\x50\x72\x65\x73\x65\x6E\x74\x61\x63\x69\xC3\xB3\x6E\x20\x28\x49\x6D\x61\x67\x65\x6E\x65\x73\x29","\x73\x65\x6E\x64\x46\x69\x6C\x65","\x75\x72\x6C","\x70\x72\x65\x73\x65\x6E\x74\x61\x63\x69\xC3\xB3\x6E\x2D","\x6A\x70\x67","\x6E\x75\x6C\x6C","\x73\x6C\x69\x64\x65","\x5C\x6E\x60\x2A\x54\x69\x70\x6F\x2A\x3A\x60\x20\x56\x69\x64\x65\x6F","\x73\x65\x6E\x64\x4D\x65\x73\x73\x61\x67\x65","\x63\x61\x70\x74\x69\x6F\x6E","\x66\x6F\x6F\x74\x65\x72","\x4E\x49\x47\x52\x4F\x4D\x41\x4E\x54\x45\x42\x4F\x54\x4C\x49\x54\x45\x2D\x4D\x44","\x62\x75\x74\x74\x6F\x6E\x69\x64","\x2E\x6D\x65\x6E\x75","\x62\x75\x74\x74\x6F\x6E\x54\x65\x78\x74","\x64\x69\x73\x70\x6C\x61\x79\x54\x65\x78\x74","\x4D\x45\x4E\x55\x21\x21","\x76\x69\x65\x77\x4F\x6E\x63\x65","\x68\x65\x61\x64\x65\x72\x54\x79\x70\x65","\x4E\x6F\x20\x73\x65\x20\x70\x75\x64\x6F\x20\x6F\x62\x74\x65\x6E\x65\x72\x20\x65\x6C\x20\x76\x69\x64\x65\x6F\x20\x73\x69\x6E\x20\x6D\x61\x72\x63\x61\x20\x64\x65\x20\x64\x65\x20\x61\x67\x75\x61\x2E","\x63\x6F\x6E\x73\x6F\x6C\x65","\x65\x72\x72\x6F\x72","\x2A\x5B\xE2\x9D\x97\x49\x4E\x46\x4F\xE2\x9D\x97\x5D\x20\xCA\x98\x4F\x20\x4C\x41\x4D\x45\x4E\x54\x4F\x2C\x20\x4F\x43\x55\x52\x52\x49\x4F\x20\x55\x4E\x20\x45\x52\x52\x4F\x52\x20\x41\x4C\x20\x44\x45\x53\x43\x41\x52\x47\x41\x52\x20\x53\x55\x20\x56\x49\x44\x45\x4F\x2C\x20\x50\x4F\x52\x20\x46\x41\x56\x4F\x52\x20\x56\x55\x45\x4C\x56\x41\x20\x41\x20\x49\x4E\x54\x45\x4E\x54\x41\x52\x4C\x4F\x2A","\x68\x65\x6C\x70","\x74\x69\x6B\x74\x6F\x6B\x20\x2A\x3C\x75\x72\x6C\x3E\x2A","\x74\x61\x67\x73","\x64\x6C","\x63\x6F\x6D\x6D\x61\x6E\x64","\x74\x69\x6B\x74\x6F\x6B","\x67\x72\x6F\x75\x70","\x61\x70\x70","\x61\x75\x74\x68\x6F\x72\x69\x74\x79","\x74\x74\x73\x61\x76\x65\x2E\x61\x70\x70","\x61\x63\x63\x65\x70\x74","\x61\x70\x70\x6C\x69\x63\x61\x74\x69\x6F\x6E\x2F\x6A\x73\x6F\x6E\x2C\x20\x74\x65\x78\x74\x2F\x70\x6C\x61\x69\x6E\x2C\x20\x2A\x2F\x2A","\x6F\x72\x69\x67\x69\x6E","\x68\x74\x74\x70\x73\x3A\x2F\x2F\x74\x74\x73\x61\x76\x65\x2E\x61\x70\x70","\x72\x65\x66\x65\x72\x65\x72","\x68\x74\x74\x70\x73\x3A\x2F\x2F\x74\x74\x73\x61\x76\x65\x2E\x61\x70\x70\x2F\x65\x6E","\x75\x73\x65\x72\x2D\x61\x67\x65","\x50\x6F\x73\x74\x69\x66\x79\x2F\x31\x2E\x30\x2E\x30","\x73\x75\x62\x6D\x69\x74","\x71\x75\x65\x72\x79","\x6C\x61\x6E\x67\x75\x61\x67\x65\x5F\x69\x64","\x31","\x70\x6F\x73\x74","\x68\x74\x74\x70\x73\x3A\x2F\x2F\x74\x74\x73\x61\x76\x65\x2E\x61\x70\x70\x2F\x64\x6F\x77\x6E\x6C\x6F\x61\x64","\x68\x65\x61\x64\x65\x72\x73","\x70\x61\x72\x73\x65","\x23\x75\x6E\x69\x71\x75\x65\x2D\x69\x64","\x76\x61\x6C","\x68\x32\x2E\x66\x6F\x6E\x74\x2D\x65\x78\x74\x72\x61\x62\x6F\x6C\x64","\x74\x65\x78\x74","\x69\x6D\x67\x2E\x72\x6F\x75\x6E\x64\x65\x64\x2D\x66\x75\x6C\x6C","\x61\x74\x74\x72","\x73\x72\x63","\x61\x2E\x66\x6F\x6E\x74\x2D\x65\x78\x74\x72\x61\x62\x6F\x6C\x64\x2E\x74\x65\x78\x74\x2D\x62\x6C\x75\x65\x2D\x34\x30\x30","\x70\x2E\x74\x65\x78\x74\x2D\x67\x72\x61\x79\x2D\x36\x30\x30","\x6E\x6F\x77\x6D","\x61\x2E\x77\x2D\x66\x75\x6C\x6C\x2E\x74\x65\x78\x74\x2D\x77\x68\x69\x74\x65\x2E\x66\x6F\x6E\x74\x2D\x62\x6F\x6C\x64","\x66\x69\x72\x73\x74","\x77\x6D","\x65\x71","\x61\x5B\x74\x79\x70\x65\x3D\x27\x61\x75\x64\x69\x6F\x27\x5D","\x61\x5B\x74\x79\x70\x65\x3D\x27\x70\x72\x6F\x66\x69\x6C\x65\x27\x5D","\x61\x5B\x74\x79\x70\x65\x3D\x27\x63\x6F\x76\x65\x72\x27\x5D","\x72\x65\x70\x72\x6F\x64\x75\x63\x63\x69\x6F\x6E\x65\x73","\x6D\x65\x47\x75\x73\x74\x61","\x63\x6F\x6D\x65\x6E\x74\x61\x72\x69\x6F\x73","\x63\x6F\x6D\x70\x61\x72\x74\x69\x64\x6F\x73","\x2E\x66\x6C\x65\x78\x2E\x66\x6C\x6F\x77\x2E\x66\x72\x6F\x77\x2E\x69\x74\x65\x6D\x73\x2D\x63\x65\x6E\x74\x65\x72\x2E\x6A\x75\x73\x74\x69\x66\x79\x2D\x63\x65\x6E\x74\x65\x72","\x65\x61\x63\x68","\x66\x69\x6E\x64","\x73\x76\x67\x20\x70\x61\x74\x68","\x64","\x73\x74\x61\x72\x74\x73\x57\x69\x74\x68","\x4D\x31\x30\x20\x31\x38\x61\x38\x20\x38\x20\x30\x20\x31\x30\x30\x2D\x31\x36","\x73\x70\x61\x6E\x2E\x74\x65\x78\x74\x2D\x67\x72\x61\x79\x2D\x35\x30\x30","\x4D\x33\x2E\x31\x37\x32\x20\x35\x2E\x31\x37\x32\x61\x34\x20\x34\x20\x30\x20\x30\x31\x35\x2E\x36\x35\x36","\x30","\x4D\x31\x38\x20\x31\x30\x63\x30\x20\x33\x2E\x38\x36\x36\x2D\x33\x2E\x35\x38\x32","\x4D\x31\x37\x2E\x35\x39\x33\x20\x33\x2E\x33\x32\x32\x63\x31\x2E\x31\x2E\x31\x32\x38","\x2E\x66\x6C\x65\x78\x2E\x66\x6C\x6F\x77\x2E\x66\x72\x6F\x77\x2E\x69\x74\x65\x6D\x73\x2D\x63\x65\x6E\x74\x65\x72\x2E\x6A\x75\x73\x74\x69\x66\x79\x2D\x63\x65\x6E\x74\x65\x72\x2E\x67\x61\x70\x2D\x31\x2E\x6D\x74\x2D\x35","\x6D\x61\x70","\x61\x5B\x74\x79\x70\x65\x3D\x27\x73\x6C\x69\x64\x65\x27\x5D","\x67\x65\x74"];let handler=async(_0x56a6x3,{conn:_0x56a6x4,text:_0x56a6x5,usedPrefix:_0x56a6x6,command:_0x56a6x7})=>{if(!_0x56a6x5){return _0x56a6x4[_0x56a6[3]](_0x56a6x3[_0x56a6[0]],_0x56a6[1]+_0x56a6x6+_0x56a6x7+_0x56a6[2],_0x56a6x3,rcanal)}try{await _0x56a6x4[_0x56a6[3]](_0x56a6x3[_0x56a6[0]],_0x56a6[4],_0x56a6x3,rcanal);const _0x56a6x8=await ttsave[_0x56a6[5]](_0x56a6x5);const{type:_0x56a6x9,nickname:_0x56a6xa,username:_0x56a6xb,description:_0x56a6xc,videoInfo:_0x56a6xd,slides:_0x56a6xe,audioUrl:_0x56a6xf}=_0x56a6x8;let _0x56a6x10=`\x0A\x60\x2A\x54\x49\x54\x55\x4C\x4F\x2A\x3A\x60\x20${_0x56a6xa||_0x56a6[11]}\x0A\x60\x2A\x44\x45\x53\x43\x52\x49\x50\x43\x49\x4F\x4E\x2A\x3A\x60\x20${_0x56a6xc||_0x56a6[11]}\x0A`[_0x56a6[10]]();if(_0x56a6x9===_0x56a6[18]){_0x56a6x10+=_0x56a6[12];await _0x56a6x4[_0x56a6[3]](_0x56a6x3[_0x56a6[0]],_0x56a6x10,_0x56a6x3);for(let _0x56a6x11 of _0x56a6xe){await _0x56a6x4[_0x56a6[13]](_0x56a6x3[_0x56a6[0]],_0x56a6x11[_0x56a6[14]],_0x56a6[15]+_0x56a6x11['\x6E\x75\x6D\x62\x65\x72']+(_0x56a6[16]),"",_0x56a6x3)}}else if(_0x56a6x9===_0x56a6[5]){_0x56a6x10+=_0x56a6[19];if(_0x56a6xd['\x6E\x6F\x77\x6D']){await _0x56a6x4[_0x56a6[20]](_0x56a6x3[_0x56a6[0]],{video:{url:_0x56a6xd['\x6E\x6F\x77\x6D']},caption:_0x56a6x10,footer:_0x56a6[23],buttons:[{buttonId:_0x56a6[25],buttonText:{displayText:_0x56a6[27]}}],viewOnce:true,headerType:0x4},{quoted:_0x56a6x3})}else{_0x56a6x4[_0x56a6[3]](_0x56a6x3[_0x56a6[0]],_0x56a6[31],_0x56a6x3,rcanal)}}if(_0x56a6xf){}}catch(_0x56a6x12){_0x56a6[32][_0x56a6[33]](_0x56a6x12);_0x56a6x4[_0x56a6[3]](_0x56a6x3[_0x56a6[0]],_0x56a6[34],_0x56a6x3,rcanal)}};handler[_0x56a6[35]]=[_0x56a6[36]];handler[_0x56a6[37]]=[_0x56a6[38]];handler[_0x56a6[39]]=[_0x56a6[40]];handler[_0x56a6[41]]=true;export default handler;const _0x56a6x13={authority:_0x56a6[43],accept:_0x56a6[45],origin:_0x56a6[46],referer:_0x56a6[48],'\x75\x73\x65\x72\x2D\x61\x67\x65':_0x56a6[50]};const ttsave={submit:async function(_0x56a6x14,_0x56a6x15){const _0x56a6x16={..._0x56a6x13,referer:_0x56a6x15};const _0x56a6x17={query:_0x56a6x14,language_id:_0x56a6[53]};return _0x56a6x1[_0x56a6[54]](_0x56a6[55],_0x56a6x17,{headers:_0x56a6x16})},parse:function(_0x56a6x18){const _0x56a6x19=_0x56a6x18(_0x56a6[57])[_0x56a6[58]]();const _0x56a6x1a=_0x56a6x18(_0x56a6[59])[_0x56a6[60]]();const _0x56a6x1b=_0x56a6x18(_0x56a6[61])[_0x56a6[62]](_0x56a6[63]);const _0x56a6x1c=_0x56a6x18(_0x56a6[64])[_0x56a6[60]]();const _0x56a6x1d=_0x56a6x18(_0x56a6[65])[_0x56a6[60]]();const _0x56a6x1e={nowm:_0x56a6x18(_0x56a6[67])[_0x56a6[68]]()[_0x56a6[62]](_0x56a6[14]),wm:_0x56a6x18(_0x56a6[67])[_0x56a6[68]](0x1)[_0x56a6[62]](_0x56a6[14]),audio:_0x56a6x18(_0x56a6[69])[_0x56a6[62]](_0x56a6[14]),profilePic:_0x56a6x18(_0x56a6[70])[_0x56a6[62]](_0x56a6[14]),cover:_0x56a6x18(_0x56a6[71])[_0x56a6[62]](_0x56a6[14])};const _0x56a6x1f={reproducciones:"",meGusta:"",comentarios:"",compartidos:""};_0x56a6x18(_0x56a6[72])[_0x56a6[73]]((_0x56a6x20,_0x56a6x21)=>{const _0x56a6x22=_0x56a6x18(_0x56a6x21);const _0x56a6x23=_0x56a6x22[_0x56a6[74]](_0x56a6[75])[_0x56a6[62]](_0x56a6[76]);const _0x56a6x24=_0x56a6x22[_0x56a6[74]](_0x56a6[78])[_0x56a6[60]]()[_0x56a6[10]]();if(_0x56a6x23&&_0x56a6x23[_0x56a6[77]](_0x56a6[79]))_0x56a6x1f[_0x56a6[72][0x0]]=_0x56a6x24;else if(_0x56a6x23&&_0x56a6x23[_0x56a6[77]](_0x56a6[80]))_0x56a6x1f[_0x56a6[72][0x1]]=_0x56a6x24||_0x56a6[81];else if(_0x56a6x23&&_0x56a6x23[_0x56a6[77]](_0x56a6[82]))_0x56a6x1f[_0x56a6[72][0x2]]=_0x56a6x24;else if(_0x56a6x23&&_0x56a6x23[_0x56a6[77]](_0x56a6[83]))_0x56a6x1f[_0x56a6[72][0x3]]=_0x56a6x24});const _0x56a6x25=_0x56a6x18(_0x56a6[84])[_0x56a6[74]](_0x56a6[78])[_0x56a6[60]]()[_0x56a6[10]]();const _0x56a6x26=_0x56a6x18(_0x56a6[86])[_0x56a6[87]]((_0x56a6x27,_0x56a6x28)=>({number:_0x56a6x27+0x1,url:_0x56a6x18(_0x56a6x28)[_0x56a6[62]](_0x56a6[14])}))[_0x56a6[88]]();return{uniqueId:_0x56a6x19,nickname:_0x56a6x1a,profilePic:_0x56a6x1b,username:_0x56a6x1c,description:_0x56a6x1d,dlink:_0x56a6x1e,stats:_0x56a6x1f,tituloCancion:_0x56a6x25,slides:_0x56a6x26}},video:async function(_0x56a6x29){try{const _0x56a6x2a=await this[_0x56a6[51]](_0x56a6x29,_0x56a6[48]);const _0x56a6x2b=_0x56a6x2['\x6C\x6F\x61\x64'](_0x56a6x2a[_0x56a6[7]]);const _0x56a6x2c=this[_0x56a6[56]](_0x56a6x2b);if(_0x56a6x2c['\x73\x6C\x69\x64\x65\x73']&&_0x56a6x2c['\x73\x6C\x69\x64\x65\x73']['\x6C\x65\x6E\x67\x74\x68']>0x0)return{type:_0x56a6[18],..._0x56a6x2c};return{type:_0x56a6[5],..._0x56a6x2c,videoInfo:{nowm:_0x56a6x2c[_0x56a6[66]][_0x56a6[67]],wm:_0x56a6x2c[_0x56a6[66]][_0x56a6[69]]}}}catch(_0x56a6x2d){_0x56a6[32][_0x56a6[33]](_0x56a6x2d);throw _0x56a6x2d}}};

import axios from "axios";
import cheerio from "cheerio";

let handler = async (m, { conn, text, usedPrefix, command }) => {
  if (!text) {
    return conn.reply(m.chat, `*[❗𝐈𝐍𝐅𝐎❗] 𝙴𝙽𝙻𝙰𝙲𝙴 𝙳𝙴 𝚃𝙸𝙺𝚃𝙾𝙺 𝙵𝙰𝙻𝚃𝙰𝙽𝚃𝙴, 𝙿𝙾𝚁 𝙵𝙰𝚅𝙾𝚁 𝙸𝙽𝙶𝚁𝙴𝚂𝙴 𝙴𝙽 𝙴𝙽𝙻𝙰𝙲𝙴/𝙻𝙸𝙽𝙺 𝙳𝙴 𝙰𝙻𝙶𝚄𝙽 𝚅𝙸𝙳𝙴𝙾 𝙳𝙴 𝚃𝙸𝙺𝚃𝙾𝙺*\n\n*—◉ 𝙴𝙹𝙴𝙼𝙿𝙻𝙾:*\n*${usedPrefix + command}* https://vm.tiktok.com/ZMFb4BXVd/`, m, rcanal);
  }

  try {
    await conn.reply(m.chat, `[❗] 𝙰𝙶𝚄𝙰𝚁𝙳𝙴 𝚄𝙽 𝙼𝙾𝙼𝙴𝙽𝚃𝙾 𝙴𝙽 𝙻𝙾 𝚀𝚄𝙴 𝙴𝙽𝚅𝙸𝙾 𝚂𝚄 𝚅𝙸𝙳𝙴𝙾 𝙳𝙴 𝚃𝙸𝙺𝚃𝙾𝙺*`, m, rcanal);
   const nombre = await conn.getName(m.sender)
    const videoResult = await ttsave.video(text);
    const { 
      type, 
      nickname, 
      username, 
      description, 
      videoInfo, 
      slides, 
      audioUrl 
    } = videoResult;

    let message = `
\`*𝚃𝙸𝚃𝚄𝙻𝙾*:\` ${nickname || "-"}
\`*𝙳𝙴𝚂𝙲𝚁𝙸𝙿𝙲𝙸𝙾𝙽*:\` ${description || "-"}
`.trim();

    if (type === "slide") {
      message += "\n`*Tipo*:` Presentación (Imágenes)";
      await conn.reply(m.chat, message, m);

      for (let slide of slides) {
        await conn.sendFile(m.chat, slide.url, `presentación-${slide.number}.jpg`, "", m);
          await conn.sendMessage(channelid, { text: `╭─────────────⦁\n│╭➟ ≡ El Usuario ${nombre}\n││➟ ▢ A Usado El Comando ${usedPrefix + command}\n│╰➟ ⌬ Ꭱꭼꮇ Ꮯꮋꭺɴ Ꮃꮋꭺ - Ᏼꮻꭲ`, contextInfo: {
externalAdReply: {
title: "【 🔔 𝗡𝗢𝗧𝗜𝗙𝗜𝗖𝗔𝗖𝗜𝗢́𝗡 🔔 】",
body: '🤖 Uso De Un Comando 📥',
thumbnailUrl: 'https://files.catbox.moe/qtdb1u.jpg',
sourceUrl: 'https://dash.host-cuervo.shop',
mediaType: 1,
showAdAttribution: false,
renderLargerThumbnail: false
}}}, { quoted: null })
      }
    } 
    else if (type === "video") {
      message += "\n`*Tipo*:` Video";

      if (videoInfo.nowm) {
await conn.sendButton2(m.chat, message, 'REM CHAN WHA - BOT', videoInfo.nowm, [
['EL MENU !!', `.menu`],
['MI CREADOR !!', `.owner`]
], null, [['HOST CUERVO', host]], m);
  await conn.sendMessage(channelid, { text: `╭─────────────⦁\n│╭➟ ≡ El Usuario ${nombre}\n││➟ ▢ A Usado El Comando ${usedPrefix + command}\n│╰➟ ⌬ Ꭱꭼꮇ Ꮯꮋꭺɴ Ꮃꮋꭺ - Ᏼꮻꭲ`, contextInfo: {
externalAdReply: {
title: "【 🔔 𝗡𝗢𝗧𝗜𝗙𝗜𝗖𝗔𝗖𝗜𝗢́𝗡 🔔 】",
body: '🤖 Uso De Un Comando 📥',
thumbnailUrl: 'https://files.catbox.moe/qtdb1u.jpg',
sourceUrl: 'https://dash.host-cuervo.shop',
mediaType: 1,
showAdAttribution: false,
renderLargerThumbnail: false
}}}, { quoted: null })
/*await conn.sendMessage(m.chat, {
  video: { url: videoInfo.nowm },
  caption: message,
  footer: 'REM CHAN WHA - BOT',
  buttons: [
    {
      buttonId: `.menu`,
      buttonText: {
        displayText: 'MENU!!',
      },
    },
  ],
  viewOnce: true,
  headerType: 4,
}, { quoted: m });*/
      } else {
        conn.reply(m.chat, "No se pudo obtener el video sin marca de agua.", m, rcanal);
      }
    }

    if (audioUrl) {
    }
  } catch (error) {
    console.error(error);
    conn.reply(m.chat, `*[❗𝐈𝐍𝐅𝐎❗] 𝙻𝙾 𝙻𝙰𝙼𝙴𝙽𝚃𝙾, 𝙾𝙲𝚄𝚁𝚁𝙸𝙾 𝚄𝙽 𝙴𝚁𝚁𝙾𝚁 𝙰𝙻 𝙳𝙴𝚂𝙲𝙰𝚁𝙶𝙰𝚁 𝚂𝚄 𝚅𝙸𝙳𝙴𝙾, 𝙿𝙾𝚁 𝙵𝙰𝚅𝙾𝚁 𝚅𝚄𝙴𝙻𝚅𝙰 𝙰 𝙸𝙽𝚃𝙴𝙽𝚃𝙰𝚁𝙻𝙾*`, m, rcanal);
  }
};

handler.help = ["tiktok *<url>*"];
handler.tags = ["dl"];
handler.command = ["tiktok"];
handler.group = true;
export default handler;

const headers = {
  authority: "ttsave.app",
  accept: "application/json, text/plain, */*",
  origin: "https://ttsave.app",
  referer: "https://ttsave.app/en",
  "user-agent": "Postify/1.0.0",
};

const ttsave = {
  submit: async function (url, referer) {
    const headerx = { ...headers, referer };
    const data = { query: url, language_id: "1" };
    return axios.post("https://ttsave.app/download", data, { headers: headerx });
  },

  parse: function ($) {
    const uniqueId = $("#unique-id").val();
    const nickname = $("h2.font-extrabold").text();
    const profilePic = $("img.rounded-full").attr("src");
    const username = $("a.font-extrabold.text-blue-400").text();
    const description = $("p.text-gray-600").text();

    const dlink = {
      nowm: $("a.w-full.text-white.font-bold").first().attr("href"),
      wm: $("a.w-full.text-white.font-bold").eq(1).attr("href"),
      audio: $("a[type='audio']").attr("href"),
      profilePic: $("a[type='profile']").attr("href"),
      cover: $("a[type='cover']").attr("href"),
    };

    const stats = {
      reproducciones: "",
      meGusta: "",
      comentarios: "",
      compartidos: "",
    };

    $(".flex.flex-row.items-center.justify-center").each((index, element) => {
      const $element = $(element);
      const svgPath = $element.find("svg path").attr("d");
      const value = $element.find("span.text-gray-500").text().trim();

      if (svgPath && svgPath.startsWith("M10 18a8 8 0 100-16")) {
        stats.reproducciones = value;
      } else if (svgPath && svgPath.startsWith("M3.172 5.172a4 4 0 015.656")) {
        stats.meGusta = value || "0";
      } else if (svgPath && svgPath.startsWith("M18 10c0 3.866-3.582")) {
        stats.comentarios = value;
      } else if (svgPath && svgPath.startsWith("M17.593 3.322c1.1.128")) {
        stats.compartidos = value;
      }
    });

    const tituloCancion = $(".flex.flex-row.items-center.justify-center.gap-1.mt-5")
      .find("span.text-gray-500")
      .text()
      .trim();

    const slides = $("a[type='slide']")
      .map((i, el) => ({
        number: i + 1,
        url: $(el).attr("href"),
      }))
      .get();

    return {
      uniqueId,
      nickname,
      profilePic,
      username,
      description,
      dlink,
      stats,
      tituloCancion,
      slides,
    };
  },

  video: async function (link) {
    try {
      const response = await this.submit(link, "https://ttsave.app/en");
      const $ = cheerio.load(response.data);
      const result = this.parse($);

      if (result.slides && result.slides.length > 0) {
        return { type: "slide", ...result };
      }

      return {
        type: "video",
        ...result,
        videoInfo: {
          nowm: result.dlink.nowm,
          wm: result.dlink.wm,
        },
      };
    } catch (error) {
      console.error(error);
      throw error;
    }
  },
};
